"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/project/[id]/chat/page",{

/***/ "(app-pages-browser)/./src/components/chat/Chat.tsx":
/*!**************************************!*\
  !*** ./src/components/chat/Chat.tsx ***!
  \**************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Chat: function() { return /* binding */ Chat; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_dnd__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-dnd */ \"(app-pages-browser)/./node_modules/react-dnd/dist/core/DndProvider.js\");\n/* harmony import */ var react_dnd_html5_backend__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-dnd-html5-backend */ \"(app-pages-browser)/./node_modules/react-dnd-html5-backend/dist/index.js\");\n/* harmony import */ var _components_providers_SupabaseProvider__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/components/providers/SupabaseProvider */ \"(app-pages-browser)/./src/components/providers/SupabaseProvider.tsx\");\n/* harmony import */ var _ChatBubble__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ChatBubble */ \"(app-pages-browser)/./src/components/chat/ChatBubble.tsx\");\n/* harmony import */ var _lib_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/api */ \"(app-pages-browser)/./src/lib/api.ts\");\n/* harmony import */ var _barrel_optimize_names_ArrowUpRight_ChevronDown_lucide_react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowUpRight,ChevronDown!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/chevron-down.js\");\n/* harmony import */ var _barrel_optimize_names_ArrowUpRight_ChevronDown_lucide_react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowUpRight,ChevronDown!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/arrow-up-right.js\");\n/* __next_internal_client_entry_do_not_use__ Chat auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\nfunction Chat(param) {\n    let { chatId, chatType = \"plot\", initialMessages = [] } = param;\n    _s();\n    const supabase = (0,_components_providers_SupabaseProvider__WEBPACK_IMPORTED_MODULE_2__.useSupabase)();\n    const api = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>(0,_lib_api__WEBPACK_IMPORTED_MODULE_4__.createApi)(supabase), [\n        supabase\n    ]);\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialMessages);\n    const [input, setInput] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [streaming, setStreaming] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [inputError, setInputError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const listRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const inputRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const modeMenuRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const modeMenuListRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const [saving, setSaving] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [saveError, setSaveError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [pendingMode, setPendingMode] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [pendingSettings, setPendingSettings] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [toastMsg, setToastMsg] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const toastTimer = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const apiBase = \"http://localhost:3000\" || 0;\n    const [loadingHistory, setLoadingHistory] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [clientMode, setClientMode] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"chat\");\n    const [modeMenuOpen, setModeMenuOpen] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [modeMenuIndex, setModeMenuIndex] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(0);\n    const cacheKey = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>\"inkverse_chat_\".concat(chatId, \"_messages\"), [\n        chatId\n    ]);\n    const [hasCache, setHasCache] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const messagesRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(messages);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        var _listRef_current;\n        (_listRef_current = listRef.current) === null || _listRef_current === void 0 ? void 0 : _listRef_current.scrollTo({\n            top: listRef.current.scrollHeight,\n            behavior: \"smooth\"\n        });\n    }, [\n        messages.length\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        try {\n            const s =  true ? window.localStorage.getItem(cacheKey) : 0;\n            if (s) {\n                const arr = JSON.parse(s);\n                if (Array.isArray(arr)) {\n                    setMessages(arr);\n                    setHasCache(arr.length > 0);\n                }\n            }\n        } catch (e) {}\n    }, [\n        cacheKey\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        // If parent provides messages later, set them only if list is empty\n        if (initialMessages.length && messages.length === 0) {\n            setMessages(initialMessages);\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [\n        initialMessages\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        let mounted = true;\n        (async ()=>{\n            if (hasCache) {\n                return;\n            }\n            try {\n                if (!hasCache) setLoadingHistory(true);\n                const history = await api.getChatMessagesByChatId(chatId);\n                if (!mounted) return;\n                const next = Array.isArray(history) ? history : [];\n                // Skip update if no change to avoid flicker\n                try {\n                    if (hasCache && JSON.stringify(next) === JSON.stringify(messagesRef.current)) {\n                        return;\n                    }\n                } catch (e) {}\n                setMessages(next);\n            } catch (e) {\n            // swallow network errors during initial hydration/revalidation\n            } finally{\n                if (mounted) setLoadingHistory(false);\n            }\n        })();\n        return ()=>{\n            mounted = false;\n        };\n    }, [\n        api,\n        chatId,\n        hasCache\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        try {\n            if (true) window.localStorage.setItem(cacheKey, JSON.stringify(messages));\n        } catch (e) {}\n    }, [\n        messages,\n        cacheKey\n    ]);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        messagesRef.current = messages;\n    }, [\n        messages\n    ]);\n    // Auto-resize textarea height with content, up to a max then scroll\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        const el = inputRef.current;\n        if (!el) return;\n        el.style.height = \"auto\";\n        const max = 256; // px max height before scroll\n        const next = Math.min(el.scrollHeight, max);\n        el.style.height = \"\".concat(next, \"px\");\n    }, [\n        input\n    ]);\n    // Close mode menu on outside click\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        function onDocClick(e) {\n            if (!modeMenuOpen) return;\n            const t = e.target;\n            if (modeMenuRef.current && t && !modeMenuRef.current.contains(t)) {\n                setModeMenuOpen(false);\n            }\n        }\n        document.addEventListener(\"mousedown\", onDocClick);\n        return ()=>document.removeEventListener(\"mousedown\", onDocClick);\n    }, [\n        modeMenuOpen\n    ]);\n    // Keyboard: open/close menu and navigate options\n    const onModeButtonKeyDown = (e)=>{\n        if (e.key === \"ArrowDown\" || e.key === \"Enter\" || e.key === \" \") {\n            e.preventDefault();\n            setModeMenuIndex(clientMode === \"chat\" ? 0 : 1);\n            setModeMenuOpen(true);\n        } else if (e.key === \"Escape\") {\n            setModeMenuOpen(false);\n        }\n    };\n    const onMenuKeyDown = (e)=>{\n        if (e.key === \"ArrowDown\") {\n            e.preventDefault();\n            setModeMenuIndex((i)=>(i + 1) % 2);\n        } else if (e.key === \"ArrowUp\") {\n            e.preventDefault();\n            setModeMenuIndex((i)=>(i + 1 + 2) % 2);\n        } else if (e.key === \"Enter\") {\n            e.preventDefault();\n            if (modeMenuIndex === 0) setClientMode(\"chat\");\n            else setClientMode(\"action\");\n            setModeMenuOpen(false);\n        } else if (e.key === \"Escape\") {\n            setModeMenuOpen(false);\n        }\n    };\n    // Shortcut: Ctrl+L focuses input\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        function onKey(e) {\n            if ((e.ctrlKey || e.metaKey) && (e.key === \"l\" || e.key === \"L\")) {\n                var _inputRef_current;\n                e.preventDefault();\n                (_inputRef_current = inputRef.current) === null || _inputRef_current === void 0 ? void 0 : _inputRef_current.focus();\n            }\n        }\n        window.addEventListener(\"keydown\", onKey);\n        return ()=>window.removeEventListener(\"keydown\", onKey);\n    }, []);\n    // Focus menu container when opened for keyboard nav\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (modeMenuOpen) {\n            setTimeout(()=>{\n                var _modeMenuListRef_current;\n                return (_modeMenuListRef_current = modeMenuListRef.current) === null || _modeMenuListRef_current === void 0 ? void 0 : _modeMenuListRef_current.focus();\n            }, 0);\n        }\n    }, [\n        modeMenuOpen\n    ]);\n    const send = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(async (opts)=>{\n        var _opts_messageOverride;\n        const text = ((_opts_messageOverride = opts === null || opts === void 0 ? void 0 : opts.messageOverride) !== null && _opts_messageOverride !== void 0 ? _opts_messageOverride : input).trim();\n        if (!text && !(opts === null || opts === void 0 ? void 0 : opts.regeneratePanelId)) {\n            setInputError('Prompt is empty. Try something like: \"Write the opening scene of a dark fantasy.\"');\n            return;\n        }\n        setInputError(null);\n        const { data: { session } } = await supabase.auth.getSession();\n        const token = session === null || session === void 0 ? void 0 : session.access_token;\n        if (!token) return;\n        const userMessage = {\n            role: \"user\",\n            content: text,\n            panelId: (opts === null || opts === void 0 ? void 0 : opts.regeneratePanelId) || null\n        };\n        setMessages((prev)=>[\n                ...prev,\n                userMessage\n            ]);\n        setInput(\"\");\n        setStreaming(true);\n        // Mentions parsing: @chapter<number> or @\"exact title\"\n        const mNum = /@chapter\\s*([0-9]+)/i.exec(text) || /@chapter_?([0-9]+)/i.exec(text);\n        const mTitle = /@\"([^\"]+)\"/.exec(text);\n        const mentions = {};\n        if (mNum === null || mNum === void 0 ? void 0 : mNum[1]) mentions.chapter_number = parseInt(mNum[1], 10);\n        if (mTitle === null || mTitle === void 0 ? void 0 : mTitle[1]) mentions.title = mTitle[1];\n        const res = await fetch(\"\".concat(apiBase, \"/api/chat/\").concat(chatId), {\n            method: \"POST\",\n            headers: {\n                \"Authorization\": \"Bearer \".concat(token),\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                message: userMessage.content,\n                regeneratePanelId: (opts === null || opts === void 0 ? void 0 : opts.regeneratePanelId) || undefined,\n                clientMode,\n                mentions\n            })\n        });\n        if (!res.body) {\n            setStreaming(false);\n            return;\n        }\n        // Push empty assistant message to stream into\n        let assistantIndex = -1;\n        setMessages((prev)=>{\n            assistantIndex = prev.length;\n            return [\n                ...prev,\n                {\n                    role: \"assistant\",\n                    content: \"\"\n                }\n            ];\n        });\n        const reader = res.body.getReader();\n        const decoder = new TextDecoder();\n        try {\n            while(true){\n                const { value, done } = await reader.read();\n                if (done) break;\n                const chunk = decoder.decode(value, {\n                    stream: true\n                });\n                for (const line of chunk.split(\"\\n\")){\n                    const trimmed = line.trim();\n                    if (!trimmed.startsWith(\"data:\")) continue;\n                    const data = trimmed.slice(5).trim();\n                    if (!data) continue;\n                    try {\n                        const evt = JSON.parse(data);\n                        if (evt.type === \"text\" && evt.content) {\n                            setMessages((prev)=>{\n                                const copy = [\n                                    ...prev\n                                ];\n                                const msg = copy[assistantIndex];\n                                copy[assistantIndex] = {\n                                    ...msg,\n                                    content: ((msg === null || msg === void 0 ? void 0 : msg.content) || \"\") + evt.content\n                                };\n                                return copy;\n                            });\n                        } else if (evt.action === \"create_chapter\") {\n                            if (chatType !== \"plot\") continue;\n                            if (true) {\n                                window.dispatchEvent(new CustomEvent(\"workspace:create-draft\", {\n                                    detail: {\n                                        title: evt.title || \"Untitled Chapter\",\n                                        content: evt.content || \"\"\n                                    }\n                                }));\n                            }\n                        } else if (evt.action === \"confirm_mode\" && evt.mode) {\n                            continue;\n                        } else if (evt.action === \"confirm_settings\" && evt.changes) {\n                            continue;\n                        } else if (evt.type === \"image_job\") {\n                        // Optionally reflect job queued state\n                        } else if (evt.action === \"convert_to_manhwa\") {\n                            if (chatType !== \"plot\") continue;\n                            if (true) {\n                                window.dispatchEvent(new CustomEvent(\"workspace:create-draft\", {\n                                    detail: {\n                                        title: \"Converted Panels\",\n                                        panel_script: evt.panel_script\n                                    }\n                                }));\n                            }\n                        } else if (evt.action === \"update_chapter\") {\n                            if (chatType !== \"plot\") continue;\n                            if (true) {\n                                window.dispatchEvent(new CustomEvent(\"workspace:update-chapter\", {\n                                    detail: {\n                                        id: evt.id,\n                                        chapter_number: evt.chapter_number,\n                                        title: evt.title,\n                                        content: evt.content\n                                    }\n                                }));\n                            }\n                        } else if (evt.action === \"upsert_character\" && evt.item) {\n                            if (chatType !== \"character\") continue;\n                            if (true) {\n                                window.dispatchEvent(new CustomEvent(\"workspace:character-upsert\", {\n                                    detail: {\n                                        item: evt.item\n                                    }\n                                }));\n                            }\n                        } else if (evt.action === \"upsert_world\" && evt.item) {\n                            if (chatType !== \"world\") continue;\n                            if (true) {\n                                window.dispatchEvent(new CustomEvent(\"workspace:world-upsert\", {\n                                    detail: {\n                                        item: evt.item\n                                    }\n                                }));\n                            }\n                        } else if (evt.type === \"error\") {\n                            // Append error to conversation\n                            setMessages((prev)=>[\n                                    ...prev,\n                                    {\n                                        role: \"assistant\",\n                                        content: \"Error: \".concat(evt.message)\n                                    }\n                                ]);\n                        } else if (evt.type === \"done\") {\n                            setStreaming(false);\n                        }\n                    } catch (e) {\n                    // ignore partial json lines\n                    }\n                }\n            }\n        } finally{\n            setStreaming(false);\n            reader.releaseLock();\n        }\n    }, [\n        apiBase,\n        input,\n        chatId,\n        supabase,\n        clientMode,\n        chatType\n    ]);\n    const onRegenerate = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((panelId)=>{\n        void send({\n            regeneratePanelId: panelId\n        });\n    }, [\n        send\n    ]);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_dnd__WEBPACK_IMPORTED_MODULE_5__.DndProvider, {\n        backend: react_dnd_html5_backend__WEBPACK_IMPORTED_MODULE_6__.HTML5Backend,\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"h-full flex flex-col bg-bg-elevated\",\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    ref: listRef,\n                    className: \"flex-1 min-h-0 overflow-y-auto space-y-4 p-4\",\n                    children: [\n                        loadingHistory && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"text-sm text-text-secondary\",\n                            children: \"Loading previous messages…\"\n                        }, void 0, false, {\n                            fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                            lineNumber: 303,\n                            columnNumber: 13\n                        }, this),\n                        messages.map((m, i)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_ChatBubble__WEBPACK_IMPORTED_MODULE_3__.ChatBubble, {\n                                role: m.role,\n                                content: m.content,\n                                panelId: m.panelId,\n                                onRegenerate: onRegenerate,\n                                draggable: Boolean(m.panelId)\n                            }, i, false, {\n                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                lineNumber: 306,\n                                columnNumber: 13\n                            }, this)),\n                        streaming && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"text-sm text-text-secondary animate-pulse\",\n                            children: \"AI is typing…\"\n                        }, void 0, false, {\n                            fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                            lineNumber: 316,\n                            columnNumber: 13\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                    lineNumber: 301,\n                    columnNumber: 9\n                }, this),\n                toastMsg && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"fixed top-3 right-3 z-50\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"px-3 py-2 rounded bg-slate-950/90 border border-slate-800 text-slate-100 text-sm shadow-lg\",\n                        children: toastMsg\n                    }, void 0, false, {\n                        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                        lineNumber: 322,\n                        columnNumber: 11\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                    lineNumber: 321,\n                    columnNumber: 9\n                }, this),\n                (pendingMode || pendingSettings) && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"border-t border-border-default p-3 flex items-center justify-between gap-3 bg-bg-primary\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"text-sm text-text-primary\",\n                            children: [\n                                pendingMode && 'Confirm mode change to \"'.concat(pendingMode, '\"?'),\n                                pendingSettings && !pendingMode && \"Confirm applying pending settings changes?\"\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                            lineNumber: 330,\n                            columnNumber: 13\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex items-center gap-2\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    className: \"px-3 py-1.5 rounded-md border border-border-default text-text-secondary hover:bg-bg-hover transition-all duration-150\",\n                                    onClick: ()=>{\n                                        setPendingMode(null);\n                                        setPendingSettings(null);\n                                    },\n                                    children: \"Cancel\"\n                                }, void 0, false, {\n                                    fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                    lineNumber: 335,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    className: \"px-3 py-1.5 rounded-md bg-accent hover:bg-accent-hover text-white disabled:opacity-50 transition-all duration-150\",\n                                    disabled: saving || clientMode !== \"action\",\n                                    onClick: async ()=>{\n                                        setSaving(true);\n                                        setSaveError(null);\n                                        try {\n                                            if (pendingMode || pendingSettings) {\n                                                // Ignore confirmations\n                                                setPendingMode(null);\n                                                setPendingSettings(null);\n                                            }\n                                        } catch (e) {\n                                            setSaveError((e === null || e === void 0 ? void 0 : e.message) || \"Failed to save\");\n                                            setMessages((prev)=>[\n                                                    ...prev,\n                                                    {\n                                                        role: \"assistant\",\n                                                        content: \"Error persisting changes: \".concat((e === null || e === void 0 ? void 0 : e.message) || \"Failed to save\")\n                                                    }\n                                                ]);\n                                        } finally{\n                                            setSaving(false);\n                                        }\n                                    },\n                                    children: \"Confirm\"\n                                }, void 0, false, {\n                                    fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                    lineNumber: 341,\n                                    columnNumber: 15\n                                }, this),\n                                clientMode !== \"action\" && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                    className: \"text-[11px] text-text-tertiary\",\n                                    children: \"Switch to Action mode to apply\"\n                                }, void 0, false, {\n                                    fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                    lineNumber: 364,\n                                    columnNumber: 17\n                                }, this)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                            lineNumber: 334,\n                            columnNumber: 13\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                    lineNumber: 329,\n                    columnNumber: 11\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"border-t border-border-default p-3 bg-bg-primary\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex gap-3 items-end\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex-1 relative\",\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"textarea\", {\n                                        ref: inputRef,\n                                        value: input,\n                                        onChange: (e)=>setInput(e.target.value),\n                                        placeholder: \"Chat with Cascade\",\n                                        rows: 2,\n                                        className: \"w-full bg-bg-elevated border border-border-default rounded-2xl pl-12 pr-12 pt-2 pb-10 text-text-primary placeholder:text-text-tertiary outline-none focus:border-accent resize-none min-h-[80px] max-h-72 overflow-y-auto transition-colors duration-150\",\n                                        onKeyDown: (e)=>{\n                                            if (e.key === \"Enter\" && !e.shiftKey) {\n                                                e.preventDefault();\n                                                void send();\n                                            }\n                                        }\n                                    }, void 0, false, {\n                                        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                        lineNumber: 374,\n                                        columnNumber: 15\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"absolute left-2 bottom-2\",\n                                        ref: modeMenuRef,\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                type: \"button\",\n                                                className: \"text-xs px-3 py-2 rounded-lg border border-border-default \".concat(clientMode === \"chat\" ? \"text-success\" : \"text-accent\", \" bg-bg-elevated hover:bg-bg-hover inline-flex items-center gap-1.5 transition-all duration-150\"),\n                                                onClick: ()=>{\n                                                    setModeMenuIndex(clientMode === \"chat\" ? 0 : 1);\n                                                    setModeMenuOpen((v)=>!v);\n                                                },\n                                                \"aria-haspopup\": \"menu\",\n                                                \"aria-expanded\": modeMenuOpen,\n                                                onKeyDown: onModeButtonKeyDown,\n                                                title: \"Mode\",\n                                                children: [\n                                                    clientMode === \"chat\" ? \"Chat\" : \"Action\",\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowUpRight_ChevronDown_lucide_react__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n                                                        className: \"w-3 h-3\"\n                                                    }, void 0, false, {\n                                                        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                        lineNumber: 400,\n                                                        columnNumber: 19\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                lineNumber: 390,\n                                                columnNumber: 17\n                                            }, this),\n                                            modeMenuOpen && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"absolute bottom-full mb-2 left-0 w-64 rounded-lg border border-border-default bg-bg-elevated shadow-elevation p-1.5 text-xs text-text-primary z-20\",\n                                                role: \"menu\",\n                                                tabIndex: -1,\n                                                ref: modeMenuListRef,\n                                                onKeyDown: onMenuKeyDown,\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                        className: \"w-full text-left px-3 py-2.5 rounded-md hover:bg-bg-hover transition-all duration-150 \".concat(modeMenuIndex === 0 ? \"ring-1 ring-accent\" : \"\", \" \").concat(clientMode === \"chat\" ? \"bg-bg-hover\" : \"\"),\n                                                        onClick: ()=>{\n                                                            setClientMode(\"chat\");\n                                                            setModeMenuOpen(false);\n                                                        },\n                                                        children: [\n                                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                                className: \"font-semibold text-text-primary\",\n                                                                children: \"Chat\"\n                                                            }, void 0, false, {\n                                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                                lineNumber: 414,\n                                                                columnNumber: 23\n                                                            }, this),\n                                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                                className: \"text-text-tertiary text-[11px] mt-0.5\",\n                                                                children: \"Brainstorm, outline, preview. No writes.\"\n                                                            }, void 0, false, {\n                                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                                lineNumber: 415,\n                                                                columnNumber: 23\n                                                            }, this)\n                                                        ]\n                                                    }, void 0, true, {\n                                                        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                        lineNumber: 410,\n                                                        columnNumber: 21\n                                                    }, this),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                        className: \"w-full text-left px-3 py-2.5 rounded-md hover:bg-bg-hover transition-all duration-150 mt-1 \".concat(modeMenuIndex === 1 ? \"ring-1 ring-accent\" : \"\", \" \").concat(clientMode === \"action\" ? \"bg-bg-hover\" : \"\"),\n                                                        onClick: ()=>{\n                                                            setClientMode(\"action\");\n                                                            setModeMenuOpen(false);\n                                                        },\n                                                        children: [\n                                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                                className: \"font-semibold text-text-primary\",\n                                                                children: \"Action\"\n                                                            }, void 0, false, {\n                                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                                lineNumber: 421,\n                                                                columnNumber: 23\n                                                            }, this),\n                                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                                className: \"text-text-tertiary text-[11px] mt-0.5\",\n                                                                children: \"Enable saving settings and chapters.\"\n                                                            }, void 0, false, {\n                                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                                lineNumber: 422,\n                                                                columnNumber: 23\n                                                            }, this)\n                                                        ]\n                                                    }, void 0, true, {\n                                                        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                        lineNumber: 417,\n                                                        columnNumber: 21\n                                                    }, this)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                lineNumber: 403,\n                                                columnNumber: 19\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                        lineNumber: 389,\n                                        columnNumber: 15\n                                    }, this),\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                        onClick: ()=>void send(),\n                                        disabled: streaming || !input.trim(),\n                                        className: \"absolute right-2 bottom-2 bg-accent hover:bg-accent-hover disabled:opacity-40 disabled:cursor-not-allowed text-white w-8 h-8 rounded-lg inline-flex items-center justify-center transition-all duration-150\",\n                                        title: \"Send\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowUpRight_ChevronDown_lucide_react__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n                                                className: \"w-4 h-4\",\n                                                \"aria-hidden\": \"true\"\n                                            }, void 0, false, {\n                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                lineNumber: 433,\n                                                columnNumber: 17\n                                            }, this),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                className: \"sr-only\",\n                                                children: \"Send\"\n                                            }, void 0, false, {\n                                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                                lineNumber: 434,\n                                                columnNumber: 17\n                                            }, this)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                        lineNumber: 427,\n                                        columnNumber: 15\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                                lineNumber: 373,\n                                columnNumber: 13\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                            lineNumber: 371,\n                            columnNumber: 11\n                        }, this),\n                        inputError && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"mt-2 text-xs text-red-400 p-2 rounded-lg bg-red-950/20 border border-red-500/20\",\n                            children: inputError\n                        }, void 0, false, {\n                            fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                            lineNumber: 438,\n                            columnNumber: 26\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n                    lineNumber: 370,\n                    columnNumber: 9\n                }, this)\n            ]\n        }, void 0, true, {\n            fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n            lineNumber: 299,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/home/lalaina/InkVerse/client/src/components/chat/Chat.tsx\",\n        lineNumber: 298,\n        columnNumber: 5\n    }, this);\n}\n_s(Chat, \"V/sCbzveP6T0G6qFcZ9lZ8tpL8g=\", false, function() {\n    return [\n        _components_providers_SupabaseProvider__WEBPACK_IMPORTED_MODULE_2__.useSupabase\n    ];\n});\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9jb21wb25lbnRzL2NoYXQvQ2hhdC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUUwRTtBQUVsQztBQUNlO0FBQ2U7QUFDNUI7QUFDSjtBQUNtQjtBQVNsRCxTQUFTWSxLQUFLLEtBQStJO1FBQS9JLEVBQUVDLE1BQU0sRUFBRUMsV0FBVyxNQUFNLEVBQUVDLGtCQUFrQixFQUFFLEVBQThGLEdBQS9JOztJQUNuQixNQUFNQyxXQUFXVCxtRkFBV0E7SUFDNUIsTUFBTVUsTUFBTWYsOENBQU9BLENBQUMsSUFBTU8sbURBQVNBLENBQUNPLFdBQVc7UUFBQ0E7S0FBUztJQUN6RCxNQUFNLENBQUNFLFVBQVVDLFlBQVksR0FBR2YsK0NBQVFBLENBQWdCVztJQUN4RCxNQUFNLENBQUNLLE9BQU9DLFNBQVMsR0FBR2pCLCtDQUFRQSxDQUFDO0lBQ25DLE1BQU0sQ0FBQ2tCLFdBQVdDLGFBQWEsR0FBR25CLCtDQUFRQSxDQUFDO0lBQzNDLE1BQU0sQ0FBQ29CLFlBQVlDLGNBQWMsR0FBR3JCLCtDQUFRQSxDQUFnQjtJQUM1RCxNQUFNc0IsVUFBVXZCLDZDQUFNQSxDQUFpQjtJQUN2QyxNQUFNd0IsV0FBV3hCLDZDQUFNQSxDQUFzQjtJQUM3QyxNQUFNeUIsY0FBY3pCLDZDQUFNQSxDQUFpQjtJQUMzQyxNQUFNMEIsa0JBQWtCMUIsNkNBQU1BLENBQWlCO0lBRS9DLE1BQU0sQ0FBQzJCLFFBQVFDLFVBQVUsR0FBRzNCLCtDQUFRQSxDQUFDO0lBQ3JDLE1BQU0sQ0FBQzRCLFdBQVdDLGFBQWEsR0FBRzdCLCtDQUFRQSxDQUFnQjtJQUUxRCxNQUFNLENBQUM4QixhQUFhQyxlQUFlLEdBQUcvQiwrQ0FBUUEsQ0FBd0M7SUFDdEYsTUFBTSxDQUFDZ0MsaUJBQWlCQyxtQkFBbUIsR0FBR2pDLCtDQUFRQSxDQUFhO0lBQ25FLE1BQU0sQ0FBQ2tDLFVBQVVDLFlBQVksR0FBR25DLCtDQUFRQSxDQUFTO0lBQ2pELE1BQU1v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Z0RBQUM0SixXQUFVO2dEQUFVb0IsZUFBWTs7Ozs7OzBEQUM5Qyw4REFBQ1g7Z0RBQUtULFdBQVU7MERBQVU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O3dCQUkvQjlJLDRCQUFjLDhEQUFDNkk7NEJBQUlDLFdBQVU7c0NBQW1GOUk7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTzNIO0dBMWFnQlo7O1FBQ0dMLCtFQUFXQTs7O0tBRGRLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9jb21wb25lbnRzL2NoYXQvQ2hhdC50c3g/NWUxMiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBjbGllbnRcIjtcblxuaW1wb3J0IHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlTWVtbywgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB0eXBlIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IERuZFByb3ZpZGVyIH0gZnJvbSAncmVhY3QtZG5kJztcbmltcG9ydCB7IEhUTUw1QmFja2VuZCB9IGZyb20gJ3JlYWN0LWRuZC1odG1sNS1iYWNrZW5kJztcbmltcG9ydCB7IHVzZVN1cGFiYXNlIH0gZnJvbSAnQC9jb21wb25lbnRzL3Byb3ZpZGVycy9TdXBhYmFzZVByb3ZpZGVyJztcbmltcG9ydCB7IENoYXRCdWJibGUgfSBmcm9tICcuL0NoYXRCdWJibGUnO1xuaW1wb3J0IHsgY3JlYXRlQXBpIH0gZnJvbSAnQC9saWIvYXBpJztcbmltcG9ydCB7IEFycm93VXBSaWdodCwgQ2hldnJvbkRvd24gfSBmcm9tICdsdWNpZGUtcmVhY3QnO1xuXG5leHBvcnQgdHlwZSBDaGF0TWVzc2FnZSA9IHtcbiAgaWQ/OiBzdHJpbmc7XG4gIHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHBhbmVsSWQ/OiBzdHJpbmcgfCBudWxsO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIENoYXQoeyBjaGF0SWQsIGNoYXRUeXBlID0gJ3Bsb3QnLCBpbml0aWFsTWVzc2FnZXMgPSBbXSB9OiB7IGNoYXRJZDogc3RyaW5nOyBjaGF0VHlwZT86ICdwbG90J3wnY2hhcmFjdGVyJ3wnd29ybGQnOyBpbml0aWFsTWVzc2FnZXM/OiBDaGF0TWVzc2FnZVtdIH0pIHtcbiAgY29uc3Qgc3VwYWJhc2UgPSB1c2VTdXBhYmFzZSgpO1xuICBjb25zdCBhcGkgPSB1c2VNZW1vKCgpID0+IGNyZWF0ZUFwaShzdXBhYmFzZSksIFtzdXBhYmFzZV0pO1xuICBjb25zdCBbbWVzc2FnZXMsIHNldE1lc3NhZ2VzXSA9IHVzZVN0YXRlPENoYXRNZXNzYWdlW10+KGluaXRpYWxNZXNzYWdlcyk7XG4gIGNvbnN0IFtpbnB1dCwgc2V0SW5wdXRdID0gdXNlU3RhdGUoJycpO1xuICBjb25zdCBbc3RyZWFtaW5nLCBzZXRTdHJlYW1pbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaW5wdXRFcnJvciwgc2V0SW5wdXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcbiAgY29uc3QgbGlzdFJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbCk7XG4gIGNvbnN0IGlucHV0UmVmID0gdXNlUmVmPEhUTUxUZXh0QXJlYUVsZW1lbnQ+KG51bGwpO1xuICBjb25zdCBtb2RlTWVudVJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbCk7XG4gIGNvbnN0IG1vZGVNZW51TGlzdFJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbCk7XG5cbiAgY29uc3QgW3NhdmluZywgc2V0U2F2aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3NhdmVFcnJvciwgc2V0U2F2ZUVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuXG4gIGNvbnN0IFtwZW5kaW5nTW9kZSwgc2V0UGVuZGluZ01vZGVdID0gdXNlU3RhdGU8J25vdmVsJyB8ICdtYW5od2EnIHwgJ2NvbnZlcnQnIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtwZW5kaW5nU2V0dGluZ3MsIHNldFBlbmRpbmdTZXR0aW5nc10gPSB1c2VTdGF0ZTxhbnkgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW3RvYXN0TXNnLCBzZXRUb2FzdE1zZ10gPSB1c2VTdGF0ZTxzdHJpbmc+KCcnKTtcbiAgY29uc3QgdG9hc3RUaW1lciA9IHVzZVJlZjxSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0PiB8IG51bGw+KG51bGwpO1xuXG4gIGNvbnN0IGFwaUJhc2UgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUElfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuXG4gIGNvbnN0IFtsb2FkaW5nSGlzdG9yeSwgc2V0TG9hZGluZ0hpc3RvcnldID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuICBjb25zdCBbY2xpZW50TW9kZSwgc2V0Q2xpZW50TW9kZV0gPSB1c2VTdGF0ZTwnY2hhdCcgfCAnYWN0aW9uJz4oJ2NoYXQnKTtcbiAgY29uc3QgW21vZGVNZW51T3Blbiwgc2V0TW9kZU1lbnVPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW21vZGVNZW51SW5kZXgsIHNldE1vZGVNZW51SW5kZXhdID0gdXNlU3RhdGU8bnVtYmVyPigwKTtcblxuICBjb25zdCBjYWNoZUtleSA9IHVzZU1lbW8oKCkgPT4gYGlua3ZlcnNlX2NoYXRfJHtjaGF0SWR9X21lc3NhZ2VzYCwgW2NoYXRJZF0pO1xuICBjb25zdCBbaGFzQ2FjaGUsIHNldEhhc0NhY2hlXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgbWVzc2FnZXNSZWYgPSB1c2VSZWY8Q2hhdE1lc3NhZ2VbXT4obWVzc2FnZXMpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbGlzdFJlZi5jdXJyZW50Py5zY3JvbGxUbyh7IHRvcDogbGlzdFJlZi5jdXJyZW50LnNjcm9sbEhlaWdodCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pO1xuICB9LCBbbWVzc2FnZXMubGVuZ3RoXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcyA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGNhY2hlS2V5KSA6IG51bGw7XG4gICAgICBpZiAocykge1xuICAgICAgICBjb25zdCBhcnIgPSBKU09OLnBhcnNlKHMpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7XG4gICAgICAgICAgc2V0TWVzc2FnZXMoYXJyIGFzIENoYXRNZXNzYWdlW10pO1xuICAgICAgICAgIHNldEhhc0NhY2hlKChhcnIgYXMgYW55W10pLmxlbmd0aCA+IDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCB7fVxuICB9LCBbY2FjaGVLZXldKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIElmIHBhcmVudCBwcm92aWRlcyBtZXNzYWdlcyBsYXRlciwgc2V0IHRoZW0gb25seSBpZiBsaXN0IGlzIGVtcHR5XG4gICAgaWYgKGluaXRpYWxNZXNzYWdlcy5sZW5ndGggJiYgbWVzc2FnZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICBzZXRNZXNzYWdlcyhpbml0aWFsTWVzc2FnZXMpO1xuICAgIH1cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIH0sIFtpbml0aWFsTWVzc2FnZXNdKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxldCBtb3VudGVkID0gdHJ1ZTtcbiAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKGhhc0NhY2hlKSB7IHJldHVybjsgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFoYXNDYWNoZSkgc2V0TG9hZGluZ0hpc3RvcnkodHJ1ZSk7XG4gICAgICAgIGNvbnN0IGhpc3RvcnkgPSBhd2FpdCBhcGkuZ2V0Q2hhdE1lc3NhZ2VzQnlDaGF0SWQoY2hhdElkKTtcbiAgICAgICAgaWYgKCFtb3VudGVkKSByZXR1cm47XG4gICAgICAgIGNvbnN0IG5leHQgPSBBcnJheS5pc0FycmF5KGhpc3RvcnkpID8gaGlzdG9yeSBhcyBhbnkgOiBbXTtcbiAgICAgICAgLy8gU2tpcCB1cGRhdGUgaWYgbm8gY2hhbmdlIHRvIGF2b2lkIGZsaWNrZXJcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAoaGFzQ2FjaGUgJiYgSlNPTi5zdHJpbmdpZnkobmV4dCkgPT09IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VzUmVmLmN1cnJlbnQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIHt9XG4gICAgICAgIHNldE1lc3NhZ2VzKG5leHQpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIHN3YWxsb3cgbmV0d29yayBlcnJvcnMgZHVyaW5nIGluaXRpYWwgaHlkcmF0aW9uL3JldmFsaWRhdGlvblxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKG1vdW50ZWQpIHNldExvYWRpbmdIaXN0b3J5KGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KSgpO1xuICAgIHJldHVybiAoKSA9PiB7IG1vdW50ZWQgPSBmYWxzZTsgfTtcbiAgfSwgW2FwaSwgY2hhdElkLCBoYXNDYWNoZV0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGNhY2hlS2V5LCBKU09OLnN0cmluZ2lmeShtZXNzYWdlcykpO1xuICAgIH0gY2F0Y2gge31cbiAgfSwgW21lc3NhZ2VzLCBjYWNoZUtleV0pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7IG1lc3NhZ2VzUmVmLmN1cnJlbnQgPSBtZXNzYWdlczsgfSwgW21lc3NhZ2VzXSk7XG5cbiAgLy8gQXV0by1yZXNpemUgdGV4dGFyZWEgaGVpZ2h0IHdpdGggY29udGVudCwgdXAgdG8gYSBtYXggdGhlbiBzY3JvbGxcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBlbCA9IGlucHV0UmVmLmN1cnJlbnQ7XG4gICAgaWYgKCFlbCkgcmV0dXJuO1xuICAgIGVsLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICBjb25zdCBtYXggPSAyNTY7IC8vIHB4IG1heCBoZWlnaHQgYmVmb3JlIHNjcm9sbFxuICAgIGNvbnN0IG5leHQgPSBNYXRoLm1pbihlbC5zY3JvbGxIZWlnaHQsIG1heCk7XG4gICAgZWwuc3R5bGUuaGVpZ2h0ID0gYCR7bmV4dH1weGA7XG4gIH0sIFtpbnB1dF0pO1xuXG4gIC8vIENsb3NlIG1vZGUgbWVudSBvbiBvdXRzaWRlIGNsaWNrXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZnVuY3Rpb24gb25Eb2NDbGljayhlOiBNb3VzZUV2ZW50KSB7XG4gICAgICBpZiAoIW1vZGVNZW51T3BlbikgcmV0dXJuO1xuICAgICAgY29uc3QgdCA9IGUudGFyZ2V0IGFzIE5vZGUgfCBudWxsO1xuICAgICAgaWYgKG1vZGVNZW51UmVmLmN1cnJlbnQgJiYgdCAmJiAhbW9kZU1lbnVSZWYuY3VycmVudC5jb250YWlucyh0KSkge1xuICAgICAgICBzZXRNb2RlTWVudU9wZW4oZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvbkRvY0NsaWNrKTtcbiAgICByZXR1cm4gKCkgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgb25Eb2NDbGljayk7XG4gIH0sIFttb2RlTWVudU9wZW5dKTtcblxuICAvLyBLZXlib2FyZDogb3Blbi9jbG9zZSBtZW51IGFuZCBuYXZpZ2F0ZSBvcHRpb25zXG4gIGNvbnN0IG9uTW9kZUJ1dHRvbktleURvd24gPSAoZTogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MQnV0dG9uRWxlbWVudD4pID0+IHtcbiAgICBpZiAoZS5rZXkgPT09ICdBcnJvd0Rvd24nIHx8IGUua2V5ID09PSAnRW50ZXInIHx8IGUua2V5ID09PSAnICcpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHNldE1vZGVNZW51SW5kZXgoY2xpZW50TW9kZSA9PT0gJ2NoYXQnID8gMCA6IDEpO1xuICAgICAgc2V0TW9kZU1lbnVPcGVuKHRydWUpO1xuICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICBzZXRNb2RlTWVudU9wZW4oZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBvbk1lbnVLZXlEb3duID0gKGU6IFJlYWN0LktleWJvYXJkRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSAnQXJyb3dEb3duJykge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgc2V0TW9kZU1lbnVJbmRleCgoaSkgPT4gKGkgKyAxKSAlIDIpO1xuICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdBcnJvd1VwJykge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgc2V0TW9kZU1lbnVJbmRleCgoaSkgPT4gKGkgKyAxICsgMikgJSAyKTtcbiAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAobW9kZU1lbnVJbmRleCA9PT0gMCkgc2V0Q2xpZW50TW9kZSgnY2hhdCcpO1xuICAgICAgZWxzZSBzZXRDbGllbnRNb2RlKCdhY3Rpb24nKTtcbiAgICAgIHNldE1vZGVNZW51T3BlbihmYWxzZSk7XG4gICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHNldE1vZGVNZW51T3BlbihmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFNob3J0Y3V0OiBDdHJsK0wgZm9jdXNlcyBpbnB1dFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGZ1bmN0aW9uIG9uS2V5KGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgIGlmICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgKGUua2V5ID09PSAnbCcgfHwgZS5rZXkgPT09ICdMJykpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpbnB1dFJlZi5jdXJyZW50Py5mb2N1cygpO1xuICAgICAgfVxuICAgIH1cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uS2V5KTtcbiAgICByZXR1cm4gKCkgPT4gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBvbktleSk7XG4gIH0sIFtdKTtcblxuICAvLyBGb2N1cyBtZW51IGNvbnRhaW5lciB3aGVuIG9wZW5lZCBmb3Iga2V5Ym9hcmQgbmF2XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKG1vZGVNZW51T3Blbikge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiBtb2RlTWVudUxpc3RSZWYuY3VycmVudD8uZm9jdXMoKSwgMCk7XG4gICAgfVxuICB9LCBbbW9kZU1lbnVPcGVuXSk7XG5cbiAgY29uc3Qgc2VuZCA9IHVzZUNhbGxiYWNrKGFzeW5jIChvcHRzPzogeyByZWdlbmVyYXRlUGFuZWxJZD86IHN0cmluZzsgbWVzc2FnZU92ZXJyaWRlPzogc3RyaW5nIH0pID0+IHtcbiAgICBjb25zdCB0ZXh0ID0gKG9wdHM/Lm1lc3NhZ2VPdmVycmlkZSA/PyBpbnB1dCkudHJpbSgpO1xuICAgIGlmICghdGV4dCAmJiAhb3B0cz8ucmVnZW5lcmF0ZVBhbmVsSWQpIHtcbiAgICAgIHNldElucHV0RXJyb3IoJ1Byb21wdCBpcyBlbXB0eS4gVHJ5IHNvbWV0aGluZyBsaWtlOiBcIldyaXRlIHRoZSBvcGVuaW5nIHNjZW5lIG9mIGEgZGFyayBmYW50YXN5LlwiJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHNldElucHV0RXJyb3IobnVsbCk7XG5cbiAgICBjb25zdCB7IGRhdGE6IHsgc2Vzc2lvbiB9IH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcbiAgICBjb25zdCB0b2tlbiA9IHNlc3Npb24/LmFjY2Vzc190b2tlbjtcbiAgICBpZiAoIXRva2VuKSByZXR1cm47XG5cbiAgICBjb25zdCB1c2VyTWVzc2FnZTogQ2hhdE1lc3NhZ2UgPSB7IHJvbGU6ICd1c2VyJywgY29udGVudDogdGV4dCwgcGFuZWxJZDogb3B0cz8ucmVnZW5lcmF0ZVBhbmVsSWQgfHwgbnVsbCB9O1xuICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbLi4ucHJldiwgdXNlck1lc3NhZ2VdKTtcbiAgICBzZXRJbnB1dCgnJyk7XG4gICAgc2V0U3RyZWFtaW5nKHRydWUpO1xuXG4gICAgLy8gTWVudGlvbnMgcGFyc2luZzogQGNoYXB0ZXI8bnVtYmVyPiBvciBAXCJleGFjdCB0aXRsZVwiXG4gICAgY29uc3QgbU51bSA9IC9AY2hhcHRlclxccyooWzAtOV0rKS9pLmV4ZWModGV4dCkgfHwgL0BjaGFwdGVyXz8oWzAtOV0rKS9pLmV4ZWModGV4dCk7XG4gICAgY29uc3QgbVRpdGxlID0gL0BcIihbXlwiXSspXCIvLmV4ZWModGV4dCk7XG4gICAgY29uc3QgbWVudGlvbnM6IGFueSA9IHt9O1xuICAgIGlmIChtTnVtPy5bMV0pIG1lbnRpb25zLmNoYXB0ZXJfbnVtYmVyID0gcGFyc2VJbnQobU51bVsxXSwgMTApO1xuICAgIGlmIChtVGl0bGU/LlsxXSkgbWVudGlvbnMudGl0bGUgPSBtVGl0bGVbMV07XG5cbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHthcGlCYXNlfS9hcGkvY2hhdC8ke2NoYXRJZH1gLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG1lc3NhZ2U6IHVzZXJNZXNzYWdlLmNvbnRlbnQsIHJlZ2VuZXJhdGVQYW5lbElkOiBvcHRzPy5yZWdlbmVyYXRlUGFuZWxJZCB8fCB1bmRlZmluZWQsIGNsaWVudE1vZGUsIG1lbnRpb25zIH0pLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXMuYm9keSkge1xuICAgICAgc2V0U3RyZWFtaW5nKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBQdXNoIGVtcHR5IGFzc2lzdGFudCBtZXNzYWdlIHRvIHN0cmVhbSBpbnRvXG4gICAgbGV0IGFzc2lzdGFudEluZGV4ID0gLTE7XG4gICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IHtcbiAgICAgIGFzc2lzdGFudEluZGV4ID0gcHJldi5sZW5ndGg7XG4gICAgICByZXR1cm4gWy4uLnByZXYsIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6ICcnIH1dO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVhZGVyID0gcmVzLmJvZHkuZ2V0UmVhZGVyKCk7XG4gICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuXG4gICAgdHJ5IHtcbiAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIGNvbnN0IHsgdmFsdWUsIGRvbmUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgIGlmIChkb25lKSBicmVhaztcbiAgICAgICAgY29uc3QgY2h1bmsgPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG4gICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBjaHVuay5zcGxpdCgnXFxuJykpIHtcbiAgICAgICAgICBjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7XG4gICAgICAgICAgaWYgKCF0cmltbWVkLnN0YXJ0c1dpdGgoJ2RhdGE6JykpIGNvbnRpbnVlO1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSB0cmltbWVkLnNsaWNlKDUpLnRyaW0oKTtcbiAgICAgICAgICBpZiAoIWRhdGEpIGNvbnRpbnVlO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBldnQgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgaWYgKGV2dC50eXBlID09PSAndGV4dCcgJiYgZXZ0LmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb3B5ID0gWy4uLnByZXZdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1zZyA9IGNvcHlbYXNzaXN0YW50SW5kZXhdO1xuICAgICAgICAgICAgICAgIGNvcHlbYXNzaXN0YW50SW5kZXhdID0geyAuLi5tc2csIGNvbnRlbnQ6IChtc2c/LmNvbnRlbnQgfHwgJycpICsgZXZ0LmNvbnRlbnQgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29weTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2dC5hY3Rpb24gPT09ICdjcmVhdGVfY2hhcHRlcicpIHtcbiAgICAgICAgICAgICAgaWYgKGNoYXRUeXBlICE9PSAncGxvdCcpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3dvcmtzcGFjZTpjcmVhdGUtZHJhZnQnLCB7IGRldGFpbDogeyB0aXRsZTogZXZ0LnRpdGxlIHx8ICdVbnRpdGxlZCBDaGFwdGVyJywgY29udGVudDogZXZ0LmNvbnRlbnQgfHwgJycgfSB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LmFjdGlvbiA9PT0gJ2NvbmZpcm1fbW9kZScgJiYgZXZ0Lm1vZGUpIHtcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2dC5hY3Rpb24gPT09ICdjb25maXJtX3NldHRpbmdzJyAmJiBldnQuY2hhbmdlcykge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LnR5cGUgPT09ICdpbWFnZV9qb2InKSB7XG4gICAgICAgICAgICAgIC8vIE9wdGlvbmFsbHkgcmVmbGVjdCBqb2IgcXVldWVkIHN0YXRlXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2dC5hY3Rpb24gPT09ICdjb252ZXJ0X3RvX21hbmh3YScpIHtcbiAgICAgICAgICAgICAgaWYgKGNoYXRUeXBlICE9PSAncGxvdCcpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3dvcmtzcGFjZTpjcmVhdGUtZHJhZnQnLCB7IGRldGFpbDogeyB0aXRsZTogJ0NvbnZlcnRlZCBQYW5lbHMnLCBwYW5lbF9zY3JpcHQ6IGV2dC5wYW5lbF9zY3JpcHQgfSB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LmFjdGlvbiA9PT0gJ3VwZGF0ZV9jaGFwdGVyJykge1xuICAgICAgICAgICAgICBpZiAoY2hhdFR5cGUgIT09ICdwbG90JykgY29udGludWU7XG4gICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnd29ya3NwYWNlOnVwZGF0ZS1jaGFwdGVyJywgeyBkZXRhaWw6IHsgaWQ6IGV2dC5pZCwgY2hhcHRlcl9udW1iZXI6IGV2dC5jaGFwdGVyX251bWJlciwgdGl0bGU6IGV2dC50aXRsZSwgY29udGVudDogZXZ0LmNvbnRlbnQgfSB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LmFjdGlvbiA9PT0gJ3Vwc2VydF9jaGFyYWN0ZXInICYmIGV2dC5pdGVtKSB7XG4gICAgICAgICAgICAgIGlmIChjaGF0VHlwZSAhPT0gJ2NoYXJhY3RlcicpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3dvcmtzcGFjZTpjaGFyYWN0ZXItdXBzZXJ0JywgeyBkZXRhaWw6IHsgaXRlbTogZXZ0Lml0ZW0gfSB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LmFjdGlvbiA9PT0gJ3Vwc2VydF93b3JsZCcgJiYgZXZ0Lml0ZW0pIHtcbiAgICAgICAgICAgICAgaWYgKGNoYXRUeXBlICE9PSAnd29ybGQnKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCd3b3Jrc3BhY2U6d29ybGQtdXBzZXJ0JywgeyBkZXRhaWw6IHsgaXRlbTogZXZ0Lml0ZW0gfSB9KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LnR5cGUgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgLy8gQXBwZW5kIGVycm9yIHRvIGNvbnZlcnNhdGlvblxuICAgICAgICAgICAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6IGBFcnJvcjogJHtldnQubWVzc2FnZX1gIH1dKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LnR5cGUgPT09ICdkb25lJykge1xuICAgICAgICAgICAgICBzZXRTdHJlYW1pbmcoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgLy8gaWdub3JlIHBhcnRpYWwganNvbiBsaW5lc1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRTdHJlYW1pbmcoZmFsc2UpO1xuICAgICAgcmVhZGVyLnJlbGVhc2VMb2NrKCk7XG4gICAgfVxuICB9LCBbYXBpQmFzZSwgaW5wdXQsIGNoYXRJZCwgc3VwYWJhc2UsIGNsaWVudE1vZGUsIGNoYXRUeXBlXSk7XG5cbiAgY29uc3Qgb25SZWdlbmVyYXRlID0gdXNlQ2FsbGJhY2soKHBhbmVsSWQ6IHN0cmluZykgPT4ge1xuICAgIHZvaWQgc2VuZCh7IHJlZ2VuZXJhdGVQYW5lbElkOiBwYW5lbElkIH0pO1xuICB9LCBbc2VuZF0pO1xuXG4gIHJldHVybiAoXG4gICAgPERuZFByb3ZpZGVyIGJhY2tlbmQ9e0hUTUw1QmFja2VuZH0+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImgtZnVsbCBmbGV4IGZsZXgtY29sIGJnLWJnLWVsZXZhdGVkXCI+XG4gICAgICAgIHsvKiBNZXNzYWdlcyBBcmVhIHdpdGggU2Nyb2xsYmFyICovfVxuICAgICAgICA8ZGl2IHJlZj17bGlzdFJlZn0gY2xhc3NOYW1lPVwiZmxleC0xIG1pbi1oLTAgb3ZlcmZsb3cteS1hdXRvIHNwYWNlLXktNCBwLTRcIj5cbiAgICAgICAgICB7bG9hZGluZ0hpc3RvcnkgJiYgKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtdGV4dC1zZWNvbmRhcnlcIj5Mb2FkaW5nIHByZXZpb3VzIG1lc3NhZ2Vz4oCmPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7bWVzc2FnZXMubWFwKChtLCBpKSA9PiAoXG4gICAgICAgICAgICA8Q2hhdEJ1YmJsZVxuICAgICAgICAgICAgICBrZXk9e2l9XG4gICAgICAgICAgICAgIHJvbGU9e20ucm9sZX1cbiAgICAgICAgICAgICAgY29udGVudD17bS5jb250ZW50fVxuICAgICAgICAgICAgICBwYW5lbElkPXttLnBhbmVsSWR9XG4gICAgICAgICAgICAgIG9uUmVnZW5lcmF0ZT17b25SZWdlbmVyYXRlfVxuICAgICAgICAgICAgICBkcmFnZ2FibGU9e0Jvb2xlYW4obS5wYW5lbElkKX1cbiAgICAgICAgICAgIC8+KVxuICAgICAgICAgICl9XG4gICAgICAgICAge3N0cmVhbWluZyAmJiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC10ZXh0LXNlY29uZGFyeSBhbmltYXRlLXB1bHNlXCI+QUkgaXMgdHlwaW5n4oCmPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgIHt0b2FzdE1zZyAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZml4ZWQgdG9wLTMgcmlnaHQtMyB6LTUwXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJweC0zIHB5LTIgcm91bmRlZCBiZy1zbGF0ZS05NTAvOTAgYm9yZGVyIGJvcmRlci1zbGF0ZS04MDAgdGV4dC1zbGF0ZS0xMDAgdGV4dC1zbSBzaGFkb3ctbGdcIj5cbiAgICAgICAgICAgIHt0b2FzdE1zZ31cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgICAgICBcbiAgICAgICAgeyhwZW5kaW5nTW9kZSB8fCBwZW5kaW5nU2V0dGluZ3MpICYmIChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJvcmRlci10IGJvcmRlci1ib3JkZXItZGVmYXVsdCBwLTMgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIGdhcC0zIGJnLWJnLXByaW1hcnlcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXRleHQtcHJpbWFyeVwiPlxuICAgICAgICAgICAgICB7cGVuZGluZ01vZGUgJiYgYENvbmZpcm0gbW9kZSBjaGFuZ2UgdG8gXCIke3BlbmRpbmdNb2RlfVwiP2B9XG4gICAgICAgICAgICAgIHtwZW5kaW5nU2V0dGluZ3MgJiYgIXBlbmRpbmdNb2RlICYmICdDb25maXJtIGFwcGx5aW5nIHBlbmRpbmcgc2V0dGluZ3MgY2hhbmdlcz8nfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJweC0zIHB5LTEuNSByb3VuZGVkLW1kIGJvcmRlciBib3JkZXItYm9yZGVyLWRlZmF1bHQgdGV4dC10ZXh0LXNlY29uZGFyeSBob3ZlcjpiZy1iZy1ob3ZlciB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0xNTBcIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHsgc2V0UGVuZGluZ01vZGUobnVsbCk7IHNldFBlbmRpbmdTZXR0aW5ncyhudWxsKTsgfX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIENhbmNlbFxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInB4LTMgcHktMS41IHJvdW5kZWQtbWQgYmctYWNjZW50IGhvdmVyOmJnLWFjY2VudC1ob3ZlciB0ZXh0LXdoaXRlIGRpc2FibGVkOm9wYWNpdHktNTAgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMTUwXCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17c2F2aW5nIHx8IGNsaWVudE1vZGUgIT09ICdhY3Rpb24nfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2FzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgIHNldFNhdmluZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgIHNldFNhdmVFcnJvcihudWxsKTtcbiAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nTW9kZSB8fCBwZW5kaW5nU2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgY29uZmlybWF0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgIHNldFBlbmRpbmdNb2RlKG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgIHNldFBlbmRpbmdTZXR0aW5ncyhudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFNhdmVFcnJvcihlPy5tZXNzYWdlIHx8ICdGYWlsZWQgdG8gc2F2ZScpO1xuICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6IGBFcnJvciBwZXJzaXN0aW5nIGNoYW5nZXM6ICR7ZT8ubWVzc2FnZSB8fCAnRmFpbGVkIHRvIHNhdmUnfWAgfV0pO1xuICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgc2V0U2F2aW5nKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgQ29uZmlybVxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAge2NsaWVudE1vZGUgIT09ICdhY3Rpb24nICYmIChcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LVsxMXB4XSB0ZXh0LXRleHQtdGVydGlhcnlcIj5Td2l0Y2ggdG8gQWN0aW9uIG1vZGUgdG8gYXBwbHk8L3NwYW4+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cbiAgICAgICAgey8qIElucHV0IEFyZWEgLSBGaXhlZCBhdCBCb3R0b20gKi99XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYm9yZGVyLXQgYm9yZGVyLWJvcmRlci1kZWZhdWx0IHAtMyBiZy1iZy1wcmltYXJ5XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0zIGl0ZW1zLWVuZFwiPlxuICAgICAgICAgICAgey8qIElucHV0IEZpZWxkIHdpdGggSW50ZWdyYXRlZCBTZW5kIEJ1dHRvbiBhbmQgTW9kZSBTZWxlY3RvciBpbnNpZGUgKi99XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtMSByZWxhdGl2ZVwiPlxuICAgICAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgICAgICByZWY9e2lucHV0UmVmfVxuICAgICAgICAgICAgICAgIHZhbHVlPXtpbnB1dH1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldElucHV0KGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkNoYXQgd2l0aCBDYXNjYWRlXCJcbiAgICAgICAgICAgICAgICByb3dzPXsyfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBiZy1iZy1lbGV2YXRlZCBib3JkZXIgYm9yZGVyLWJvcmRlci1kZWZhdWx0IHJvdW5kZWQtMnhsIHBsLTEyIHByLTEyIHB0LTIgcGItMTAgdGV4dC10ZXh0LXByaW1hcnkgcGxhY2Vob2xkZXI6dGV4dC10ZXh0LXRlcnRpYXJ5IG91dGxpbmUtbm9uZSBmb2N1czpib3JkZXItYWNjZW50IHJlc2l6ZS1ub25lIG1pbi1oLVs4MHB4XSBtYXgtaC03MiBvdmVyZmxvdy15LWF1dG8gdHJhbnNpdGlvbi1jb2xvcnMgZHVyYXRpb24tMTUwXCJcbiAgICAgICAgICAgICAgICBvbktleURvd249eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicgJiYgIWUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB2b2lkIHNlbmQoKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB7LyogTW9kZSBTZWxlY3RvciBpbnNpZGUgaW5wdXQgYm90dG9tLWxlZnQgKi99XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJzb2x1dGUgbGVmdC0yIGJvdHRvbS0yXCIgcmVmPXttb2RlTWVudVJlZn0+XG4gICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2B0ZXh0LXhzIHB4LTMgcHktMiByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItYm9yZGVyLWRlZmF1bHQgJHtjbGllbnRNb2RlPT09J2NoYXQnID8gJ3RleHQtc3VjY2VzcycgOiAndGV4dC1hY2NlbnQnfSBiZy1iZy1lbGV2YXRlZCBob3ZlcjpiZy1iZy1ob3ZlciBpbmxpbmUtZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEuNSB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0xNTBgfVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4geyBzZXRNb2RlTWVudUluZGV4KGNsaWVudE1vZGU9PT0nY2hhdCcgPyAwIDogMSk7IHNldE1vZGVNZW51T3BlbigodikgPT4gIXYpOyB9fVxuICAgICAgICAgICAgICAgICAgYXJpYS1oYXNwb3B1cD1cIm1lbnVcIlxuICAgICAgICAgICAgICAgICAgYXJpYS1leHBhbmRlZD17bW9kZU1lbnVPcGVufVxuICAgICAgICAgICAgICAgICAgb25LZXlEb3duPXtvbk1vZGVCdXR0b25LZXlEb3dufVxuICAgICAgICAgICAgICAgICAgdGl0bGU9XCJNb2RlXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICB7Y2xpZW50TW9kZSA9PT0gJ2NoYXQnID8gJ0NoYXQnIDogJ0FjdGlvbid9XG4gICAgICAgICAgICAgICAgICA8Q2hldnJvbkRvd24gY2xhc3NOYW1lPVwidy0zIGgtM1wiIC8+XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAge21vZGVNZW51T3BlbiAmJiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIGJvdHRvbS1mdWxsIG1iLTIgbGVmdC0wIHctNjQgcm91bmRlZC1sZyBib3JkZXIgYm9yZGVyLWJvcmRlci1kZWZhdWx0IGJnLWJnLWVsZXZhdGVkIHNoYWRvdy1lbGV2YXRpb24gcC0xLjUgdGV4dC14cyB0ZXh0LXRleHQtcHJpbWFyeSB6LTIwXCJcbiAgICAgICAgICAgICAgICAgICAgcm9sZT1cIm1lbnVcIlxuICAgICAgICAgICAgICAgICAgICB0YWJJbmRleD17LTF9XG4gICAgICAgICAgICAgICAgICAgIHJlZj17bW9kZU1lbnVMaXN0UmVmfVxuICAgICAgICAgICAgICAgICAgICBvbktleURvd249e29uTWVudUtleURvd259XG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2B3LWZ1bGwgdGV4dC1sZWZ0IHB4LTMgcHktMi41IHJvdW5kZWQtbWQgaG92ZXI6YmctYmctaG92ZXIgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMTUwICR7bW9kZU1lbnVJbmRleD09PTAgPyAncmluZy0xIHJpbmctYWNjZW50JyA6ICcnfSAke2NsaWVudE1vZGU9PT0nY2hhdCcgPyAnYmctYmctaG92ZXInIDogJyd9YH1cbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7IHNldENsaWVudE1vZGUoJ2NoYXQnKTsgc2V0TW9kZU1lbnVPcGVuKGZhbHNlKTsgfX1cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9udC1zZW1pYm9sZCB0ZXh0LXRleHQtcHJpbWFyeVwiPkNoYXQ8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtdGV4dC10ZXJ0aWFyeSB0ZXh0LVsxMXB4XSBtdC0wLjVcIj5CcmFpbnN0b3JtLCBvdXRsaW5lLCBwcmV2aWV3LiBObyB3cml0ZXMuPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgdy1mdWxsIHRleHQtbGVmdCBweC0zIHB5LTIuNSByb3VuZGVkLW1kIGhvdmVyOmJnLWJnLWhvdmVyIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTE1MCBtdC0xICR7bW9kZU1lbnVJbmRleD09PTEgPyAncmluZy0xIHJpbmctYWNjZW50JyA6ICcnfSAke2NsaWVudE1vZGU9PT0nYWN0aW9uJyA/ICdiZy1iZy1ob3ZlcicgOiAnJ31gfVxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHsgc2V0Q2xpZW50TW9kZSgnYWN0aW9uJyk7IHNldE1vZGVNZW51T3BlbihmYWxzZSk7IH19XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvbnQtc2VtaWJvbGQgdGV4dC10ZXh0LXByaW1hcnlcIj5BY3Rpb248L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtdGV4dC10ZXJ0aWFyeSB0ZXh0LVsxMXB4XSBtdC0wLjVcIj5FbmFibGUgc2F2aW5nIHNldHRpbmdzIGFuZCBjaGFwdGVycy48L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHZvaWQgc2VuZCgpfVxuICAgICAgICAgICAgICAgIGRpc2FibGVkPXtzdHJlYW1pbmcgfHwgIWlucHV0LnRyaW0oKX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJhYnNvbHV0ZSByaWdodC0yIGJvdHRvbS0yIGJnLWFjY2VudCBob3ZlcjpiZy1hY2NlbnQtaG92ZXIgZGlzYWJsZWQ6b3BhY2l0eS00MCBkaXNhYmxlZDpjdXJzb3Itbm90LWFsbG93ZWQgdGV4dC13aGl0ZSB3LTggaC04IHJvdW5kZWQtbGcgaW5saW5lLWZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHRyYW5zaXRpb24tYWxsIGR1cmF0aW9uLTE1MFwiXG4gICAgICAgICAgICAgICAgdGl0bGU9XCJTZW5kXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxBcnJvd1VwUmlnaHQgY2xhc3NOYW1lPVwidy00IGgtNFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIC8+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic3Itb25seVwiPlNlbmQ8L3NwYW4+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAge2lucHV0RXJyb3IgJiYgPGRpdiBjbGFzc05hbWU9XCJtdC0yIHRleHQteHMgdGV4dC1yZWQtNDAwIHAtMiByb3VuZGVkLWxnIGJnLXJlZC05NTAvMjAgYm9yZGVyIGJvcmRlci1yZWQtNTAwLzIwXCI+e2lucHV0RXJyb3J9PC9kaXY+fVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7LyogZHJhZnRzIGFyZSByb3V0ZWQgdG8gY2VudGVyIGVkaXRvciB2aWEgd29ya3NwYWNlOmNyZWF0ZS1kcmFmdCAqL31cbiAgICA8L0RuZFByb3ZpZGVyPlxuICApO1xufVxuIl0sIm5hbWVzIjpbInVzZUNhbGxiYWNrIiwidXNlRWZmZWN0IiwidXNlTWVtbyIsInVzZVJlZiIsInVzZVN0YXRlIiwiRG5kUHJvdmlkZXIiLCJIVE1MNUJhY2tlbmQiLCJ1c2VTdXBhYmFzZSIsIkNoYXRCdWJibGUiLCJjcmVhdGVBcGkiLCJBcnJvd1VwUmlnaHQiLCJDaGV2cm9uRG93biIsIkNoYXQiLCJjaGF0SWQiLCJjaGF0VHlwZSIsImluaXRpYWxNZXNzYWdlcyIsInN1cGFiYXNlIiwiYXBpIiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsImlucHV0Iiwic2V0SW5wdXQiLCJzdHJlYW1pbmciLCJzZXRTdHJlYW1pbmciLCJpbnB1dEVycm9yIiwic2V0SW5wdXRFcnJvciIsImxpc3RSZWYiLCJpbnB1dFJlZiIsIm1vZGVNZW51UmVmIiwibW9kZU1lbnVMaXN0UmVmIiwic2F2aW5nIiwic2V0U2F2aW5nIiwic2F2ZUVycm9yIiwic2V0U2F2ZUVycm9yIiwicGVuZGluZ01vZGUiLCJzZXRQZW5kaW5nTW9kZSIsInBlbmRpbmdTZXR0aW5ncyIsInNldFBlbmRpbmdTZXR0aW5ncyIsInRvYXN0TXNnIiwic2V0VG9hc3RNc2ciLCJ0b2FzdFRpbWVyIiwiYXBpQmFzZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19BUElfVVJMIiwibG9hZGluZ0hpc3RvcnkiLCJzZXRMb2FkaW5nSGlzdG9yeSIsImNsaWVudE1vZGUiLCJzZXRDbGllbnRNb2RlIiwibW9kZU1lbnVPcGVuIiwic2V0TW9kZU1lbnVPcGVuIiwibW9kZU1lbnVJbmRleCIsInNldE1vZGVNZW51SW5kZXgiLCJjYWNoZUtleSIsImhhc0NhY2hlIiwic2V0SGFzQ2FjaGUiLCJtZXNzYWdlc1JlZiIsImN1cnJlbnQiLCJzY3JvbGxUbyIsInRvcCIsInNjcm9sbEhlaWdodCIsImJlaGF2aW9yIiwibGVuZ3RoIiwicyIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJhcnIiLCJKU09OIiwicGFyc2UiLCJBcnJheSIsImlzQXJyYXkiLCJtb3VudGVkIiwiaGlzdG9yeSIsImdldENoYXRNZXNzYWdlc0J5Q2hhdElkIiwibmV4dCIsInN0cmluZ2lmeSIsInNldEl0ZW0iLCJlbCIsInN0eWxlIiwiaGVpZ2h0IiwibWF4IiwiTWF0aCIsIm1pbiIsIm9uRG9jQ2xpY2siLCJlIiwidCIsInRhcmdldCIsImNvbnRhaW5zIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm9uTW9kZUJ1dHRvbktleURvd24iLCJrZXkiLCJwcmV2ZW50RGVmYXVsdCIsIm9uTWVudUtleURvd24iLCJpIiwib25LZXkiLCJjdHJsS2V5IiwibWV0YUtleSIsImZvY3VzIiwic2V0VGltZW91dCIsInNlbmQiLCJvcHRzIiwidGV4dCIsIm1lc3NhZ2VPdmVycmlkZSIsInRyaW0iLCJyZWdlbmVyYXRlUGFuZWxJZCIsImRhdGEiLCJzZXNzaW9uIiwiYXV0aCIsImdldFNlc3Npb24iLCJ0b2tlbiIsImFjY2Vzc190b2tlbiIsInVzZXJNZXNzYWdlIiwicm9sZSIsImNvbnRlbnQiLCJwYW5lbElkIiwicHJldiIsIm1OdW0iLCJleGVjIiwibVRpdGxlIiwibWVudGlvbnMiLCJjaGFwdGVyX251bWJlciIsInBhcnNlSW50IiwidGl0bGUiLCJyZXMiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwibWVzc2FnZSIsInVuZGVmaW5lZCIsImFzc2lzdGFudEluZGV4IiwicmVhZGVyIiwiZ2V0UmVhZGVyIiwiZGVjb2RlciIsIlRleHREZWNvZGVyIiwidmFsdWUiLCJkb25lIiwicmVhZCIsImNodW5rIiwiZGVjb2RlIiwic3RyZWFtIiwibGluZSIsInNwbGl0IiwidHJpbW1lZCIsInN0YXJ0c1dpdGgiLCJzbGljZSIsImV2dCIsInR5cGUiLCJjb3B5IiwibXNnIiwiYWN0aW9uIiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwibW9kZSIsImNoYW5nZXMiLCJwYW5lbF9zY3JpcHQiLCJpZCIsIml0ZW0iLCJyZWxlYXNlTG9jayIsIm9uUmVnZW5lcmF0ZSIsImJhY2tlbmQiLCJkaXYiLCJjbGFzc05hbWUiLCJyZWYiLCJtYXAiLCJtIiwiZHJhZ2dhYmxlIiwiQm9vbGVhbiIsImJ1dHRvbiIsIm9uQ2xpY2siLCJkaXNhYmxlZCIsInNwYW4iLCJ0ZXh0YXJlYSIsIm9uQ2hhbmdlIiwicGxhY2Vob2xkZXIiLCJyb3dzIiwib25LZXlEb3duIiwic2hpZnRLZXkiLCJ2IiwiYXJpYS1oYXNwb3B1cCIsImFyaWEtZXhwYW5kZWQiLCJ0YWJJbmRleCIsImFyaWEtaGlkZGVuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/components/chat/Chat.tsx\n"));

/***/ })

});